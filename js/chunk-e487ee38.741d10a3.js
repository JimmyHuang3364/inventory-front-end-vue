(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e487ee38"],{"00ee":function(t,e,r){"use strict";var n=r("b622"),c=n("toStringTag"),s={};s[c]="z",t.exports="[object z]"===String(s)},"0d26":function(t,e,r){"use strict";var n=r("e330"),c=Error,s=n("".replace),o=function(t){return String(new c(t).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,a=i.test(o);t.exports=function(t,e){if(a&&"string"==typeof t&&!c.prepareStackTrace)while(e--)t=s(t,i,"");return t}},1787:function(t,e,r){"use strict";var n=r("861d");t.exports=function(t){return n(t)||null===t}},2535:function(t,e,r){"use strict";var n=r("2fa3");e["a"]={getAll(){return n["h"].get("/partner_factories")}}},"271a":function(t,e,r){"use strict";var n=r("cb2d"),c=r("e330"),s=r("577e"),o=r("d6d6"),i=URLSearchParams,a=i.prototype,u=c(a.getAll),l=c(a.has),b=new i("a=1");!b.has("a",2)&&b.has("a",void 0)||n(a,"has",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return l(this,t);var n=u(this,t);o(e,1);var c=s(r),i=0;while(i<n.length)if(n[i++]===c)return!0;return!1}),{enumerable:!0,unsafe:!0})},"2ba4":function(t,e,r){"use strict";var n=r("40d5"),c=Function.prototype,s=c.apply,o=c.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(s):function(){return o.apply(s,arguments)})},"3a38":function(t,e,r){"use strict";r("bd6a")},"3bbe":function(t,e,r){"use strict";var n=r("1787"),c=String,s=TypeError;t.exports=function(t){if(n(t))return t;throw new s("Can't set "+c(t)+" as a prototype")}},"4e07":function(t,e,r){"use strict";r.r(e);var n=r("7a23");const c={key:0},s={key:1,class:"view bg-dark mb-3 p-3"},o={class:"d-flex justify-content-between align-items-center"},i={class:"form-row"},a={class:"form-group col-md-2"},u={class:"form-group col-md-2"},l={id:"partNumbers-list"},b=["value"],d={class:"form-group col-md-2"},f=["value"],p={class:"form-group col-md-2"},g=["value"],h={class:"form-group col-md-2"},O={class:"form-group col-md-2"},m={class:"mt-5"},w={class:"table table-hover table-striped table-dark"},j={style:{width:"1%"}},v=["onClick"],y={style:{width:"1%"},scope:"row"},N={style:{width:"10%"}},P={style:{width:"15%"}},I={style:{width:"15%"}},k={style:{width:"15%"}},L={style:{width:"10%"}},D={key:0,class:"d-flex justify-content-end"},x=["disabled"];function S(t,e,r,S,E,F){const A=Object(n["A"])("PageLoader");return Object(n["v"])(),Object(n["f"])("div",null,[E.isLoading?(Object(n["v"])(),Object(n["f"])("div",c,[Object(n["j"])(A)])):Object(n["e"])("",!0),E.isLoading?Object(n["e"])("",!0):(Object(n["v"])(),Object(n["f"])("div",s,[Object(n["g"])("div",o,[e[8]||(e[8]=Object(n["g"])("h1",{class:"text-white"},"新增",-1)),Object(n["g"])("div",null,[Object(n["g"])("button",{onClick:e[0]||(e[0]=Object(n["N"])((...t)=>F.addNewOutsourcingToNewoutsourcingLists&&F.addNewOutsourcingToNewoutsourcingLists(...t),["stop","prevent"])),class:"btn btn-outline-warning mr-4"},"加入")])]),Object(n["g"])("div",i,[Object(n["g"])("div",a,[e[9]||(e[9]=Object(n["g"])("label",{class:"add-form-label",for:"inputDate"},"日期",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>E.newOutsourcing.actionDate=t),type:"date",class:"form-control",id:"inputDate"},null,512),[[n["H"],E.newOutsourcing.actionDate]])]),Object(n["g"])("div",u,[e[10]||(e[10]=Object(n["g"])("label",{class:"add-form-label",for:"inputNmae"},"品番號",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>E.newOutsourcing.partNumberName=t),list:"partNumbers-list",type:"text",class:"form-control",id:"inputName"},null,512),[[n["H"],E.newOutsourcing.partNumberName]]),Object(n["g"])("datalist",l,[(Object(n["v"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(E.partNumbersList,t=>(Object(n["v"])(),Object(n["f"])("option",{key:t.id,value:t.name},null,8,b))),128))])]),Object(n["g"])("div",d,[e[12]||(e[12]=Object(n["g"])("label",{class:"add-form-label",for:"inputNmae"},"廠商",-1)),Object(n["L"])(Object(n["g"])("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>E.newOutsourcing.partnerFactoryId=t),class:"custom-select",id:"inputPartnerFactoryName"},[e[11]||(e[11]=Object(n["g"])("option",{value:"",selected:""},"Choose...",-1)),(Object(n["v"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(E.partnerFactories,t=>(Object(n["v"])(),Object(n["f"])("option",{key:t.id,value:t.id},Object(n["D"])(t.name),9,f))),128))],512),[[n["G"],E.newOutsourcing.partnerFactoryId]])]),Object(n["g"])("div",p,[e[14]||(e[14]=Object(n["g"])("label",{class:"add-form-label",for:"inputNmae"},"製程",-1)),Object(n["L"])(Object(n["g"])("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>E.newOutsourcing.productionProcessItemId=t),class:"custom-select",id:"inputPartnerFactoryName"},[e[13]||(e[13]=Object(n["g"])("option",{value:"",selected:""},"Choose...",-1)),(Object(n["v"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(E.productionProcessItems,t=>(Object(n["v"])(),Object(n["f"])("option",{key:t.id,value:t.id},Object(n["D"])(t.processName),9,g))),128))],512),[[n["G"],E.newOutsourcing.productionProcessItemId]])]),Object(n["g"])("div",h,[e[15]||(e[15]=Object(n["g"])("label",{class:"add-form-label",for:"inputQuantity"},"數量",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>E.newOutsourcing.quantity=t),type:"number",class:"form-control",id:"inputQuantity"},null,512),[[n["H"],E.newOutsourcing.quantity]])]),Object(n["g"])("div",O,[e[16]||(e[16]=Object(n["g"])("label",{class:"add-form-label",for:"inputNote"},"備註",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>E.newOutsourcing.note=t),type:"text",class:"form-control",id:"inputNote",placeholder:"可空白..."},null,512),[[n["H"],E.newOutsourcing.note]])])]),Object(n["g"])("div",null,[Object(n["L"])(Object(n["g"])("div",m,[e[18]||(e[18]=Object(n["g"])("h1",{class:"text-light text-center"},"清單",-1)),Object(n["g"])("table",w,[e[17]||(e[17]=Object(n["g"])("thead",null,[Object(n["g"])("tr",null,[Object(n["g"])("th",{scope:"col"}),Object(n["g"])("th",{scope:"col"},"#"),Object(n["g"])("th",{scope:"col"},"日期"),Object(n["g"])("th",{scope:"col"},"品番"),Object(n["g"])("th",{scope:"col"},"廠商"),Object(n["g"])("th",{scope:"col"},"製程"),Object(n["g"])("th",{scope:"col"},"數量"),Object(n["g"])("th",{scope:"col"},"備註")])],-1)),Object(n["g"])("tbody",null,[(Object(n["v"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(E.newOutsourcingLists,(t,e)=>(Object(n["v"])(),Object(n["f"])("tr",{key:e},[Object(n["g"])("td",j,[Object(n["g"])("button",{onClick:Object(n["N"])(t=>F.removeItem(e),["stop","prevent"]),class:"btn btn-outline-danger btn-sm rounded-circle"}," X ",8,v)]),Object(n["g"])("th",y,Object(n["D"])(e+1),1),Object(n["g"])("td",N,Object(n["D"])(t.actionDate),1),Object(n["g"])("td",P,Object(n["D"])(t.partNumberName),1),Object(n["g"])("td",I,Object(n["D"])(t.partnerFactoryName),1),Object(n["g"])("td",k,Object(n["D"])(t.productionProcessItemName),1),Object(n["g"])("td",L,Object(n["D"])(t.quantity),1),Object(n["g"])("td",null,Object(n["D"])(t.note),1)]))),128))])])],512),[[n["I"],E.newOutsourcingLists.length>0]])]),E.newOutsourcingLists.length>0?(Object(n["v"])(),Object(n["f"])("div",D,[Object(n["g"])("button",{onClick:e[7]||(e[7]=Object(n["N"])((...t)=>F.handleAfterSubmit&&F.handleAfterSubmit(...t),["stop","prevent"])),type:"submit",class:"btn btn-primary",disabled:E.isProcessing},Object(n["D"])(E.isProcessing?"處理中...":"送出"),9,x)])):Object(n["e"])("",!0)]))])}r("d9e2"),r("14d9");var E=r("9f3a"),F=r("2fa3"),A=r("d021"),T=r("575a"),_=r("2535"),U=r("f2c5"),C={name:"OutsourcingView",components:{PageLoader:E["a"]},created(){this.fetchTodaysDate(),this.fetchPartNumers(),this.fetchPartnerFactories(),this.fetchProductionProcessItems(),this.isLoading=!1},data(){return{blankNewOutsourcing:{actionDate:"",partNumberName:"",partnerFactoryName:"",productionProcessItemName:"",partNumberId:"",partnerFactoryId:"",productionProcessItemId:"",quantity:null,note:""},newOutsourcing:{actionDate:"",partNumberName:"",partnerFactoryName:"",productionProcessItemName:"",partNumberId:"",partnerFactoryId:"",productionProcessItemId:"",quantity:null,note:""},newOutsourcingLists:[],partNumbersList:[],partnerFactories:[],productionProcessItems:[],isLoading:!0,isProcessing:!1}},methods:{async fetchPartNumers(){try{const{data:t,status:e,statusText:r}=await T["a"].getPartNumbers();if("OK"!==r&&200!==e)throw new Error;const{partNumbers:n}=t;this.partNumbersList=n}catch(t){F["c"].fire({icon:"error",title:"載入資料錯誤，請稍後在試。"})}},async fetchPartnerFactories(){try{const{data:t,status:e,statusText:r}=await _["a"].getAll(),{partnerFactories:n}=t;if("OK"!==r&&200!==e)throw new Error;if("success"!==t.status)throw new Error(t.message);this.partnerFactories=n}catch(t){F["c"].fire({icon:"error",title:t||"拿取協力商清單錯誤，請稍後再試。"})}},async fetchProductionProcessItems(){try{const{data:t,status:e,statusText:r}=await U["a"].getAll(),{productionProcessItems:n}=t;if("OK"!==r&&200!==e)throw new Error;if("success"!==t.status)throw new Error(t.message);this.productionProcessItems=n}catch(t){F["c"].fire({icon:"error",title:t||"拿取製程項目清單錯誤，請稍後再試。"})}},addNewOutsourcingToNewoutsourcingLists(){try{if(!this.verifyDataAfterAddNewClick())throw new Error("日期、品番號、廠商、製程、數量不可空白");if(!this.checkQuantity())throw new Error("數量不足以發包");this.fetchAllItemIdAfterSubmit(),this.newOutsourcingLists.push(this.newOutsourcing),this.newOutsourcing={...this.blankNewOutsourcing}}catch(t){F["c"].fire({icon:"error",title:t||"拿取製程項目清單錯誤，請稍後再試。"})}},verifyDataAfterAddNewClick(){if(""!==this.newOutsourcing.actionDate&&""!==this.newOutsourcing.partNumberName&&""!==this.newOutsourcing.partnerFactoryId&&""!==this.newOutsourcing.productionProcessItemId&&Number(this.newOutsourcing.quantity)>0)return!0},fetchAllItemIdAfterSubmit(){this.partNumbersList.map(t=>{if(t.name===this.newOutsourcing.partNumberName)return this.newOutsourcing.partNumberId=t.id}),this.partnerFactories.map(t=>{if(t.id===this.newOutsourcing.partnerFactoryId)return this.newOutsourcing.partnerFactoryName=t.name}),this.productionProcessItems.map(t=>{if(t.id===this.newOutsourcing.productionProcessItemId)return this.newOutsourcing.productionProcessItemName=t.processName})},checkQuantity(){let t=-1,e=this.partNumbersList.length;while(t+1!==e){let r=Math.floor((t+e)/2);if(this.partNumbersList[r].name===this.newOutsourcing.partNumberName)return!(this.partNumbersList[r].quantity<this.newOutsourcing.quantity);this.partNumbersList[r].name<this.newOutsourcing.partNumberName?t=r:e=r}return!1},removeItem(t){try{this.newOutsourcingLists.splice(t,1)}catch(e){F["c"].fire({icon:"error",title:"錯誤，再試一次。"})}},async handleAfterSubmit(){try{this.isProcessing=!0;const t=new FormData;t.append("outsourcinglist",JSON.stringify(this.newOutsourcingLists));const{data:e,status:r,statusText:n}=await A["a"].Outsourcinglist.create(t);if(200!==r&&"OK"!==n)throw new Error;if("success"!==e.status)throw new Error(e.message);this.newOutsourcingLists=[],this.isProcessing=!1,F["c"].fire({icon:"success",text:e.message})}catch(t){this.isProcessing=!1,F["c"].fire({icon:"error",title:t||"拿取製程項目清單錯誤，請稍後再試。"})}},fetchTodaysDate(){let t=(new Date).getFullYear().toString(),e="",r="";e=(new Date).getMonth()<9?"0"+((new Date).getMonth()+1).toString():((new Date).getMonth()+1).toString(),r=(new Date).getDate()<10?"0"+(new Date).getDate().toString():(new Date).getDate().toString();const n=`${t}-${e}-${r}`;this.newOutsourcing.actionDate=n,this.blankNewOutsourcing.actionDate=n}}},R=(r("9451"),r("6b0d")),z=r.n(R);const q=z()(C,[["render",S],["__scopeId","data-v-27040230"]]);e["default"]=q},5494:function(t,e,r){"use strict";var n=r("83ab"),c=r("e330"),s=r("edd0"),o=URLSearchParams.prototype,i=c(o.forEach);n&&!("size"in o)&&s(o,"size",{get:function(){var t=0;return i(this,(function(){t++})),t},configurable:!0,enumerable:!0})},"575a":function(t,e,r){"use strict";r("88a7"),r("271a"),r("5494");var n=r("2fa3");e["a"]={getPartNumbers(t){const e=new URLSearchParams(t);return n["h"].get("/warehouse/partnumbers?"+e.toString())},getSubPartNumbers(){return n["h"].get("/warehouse/subpartnumbers")},getSearchPartNumbers(t){const e=new URLSearchParams(t);return n["h"].get("/warehouse/partnumbers/search?"+e.toString())}}},"577e":function(t,e,r){"use strict";var n=r("f5df"),c=String;t.exports=function(t){if("Symbol"===n(t))throw new TypeError("Cannot convert a Symbol value to a string");return c(t)}},"6f19":function(t,e,r){"use strict";var n=r("9112"),c=r("0d26"),s=r("b980"),o=Error.captureStackTrace;t.exports=function(t,e,r,i){s&&(o?o(t,e):n(t,"stack",c(r,i)))}},7156:function(t,e,r){"use strict";var n=r("1626"),c=r("861d"),s=r("d2bb");t.exports=function(t,e,r){var o,i;return s&&n(o=e.constructor)&&o!==r&&c(i=o.prototype)&&i!==r.prototype&&s(t,i),t}},7282:function(t,e,r){"use strict";var n=r("e330"),c=r("59ed");t.exports=function(t,e,r){try{return n(c(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(s){}}},"88a7":function(t,e,r){"use strict";var n=r("cb2d"),c=r("e330"),s=r("577e"),o=r("d6d6"),i=URLSearchParams,a=i.prototype,u=c(a.append),l=c(a["delete"]),b=c(a.forEach),d=c([].push),f=new i("a=1&a=2&b=3");f["delete"]("a",1),f["delete"]("b",void 0),f+""!=="a=2"&&n(a,"delete",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return l(this,t);var n=[];b(this,(function(t,e){d(n,{key:e,value:t})})),o(e,1);var c,i=s(t),a=s(r),f=0,p=0,g=!1,h=n.length;while(f<h)c=n[f++],g||c.key===i?(g=!0,l(this,c.key)):p++;while(p<h)c=n[p++],c.key===i&&c.value===a||u(this,c.key,c.value)}),{enumerable:!0,unsafe:!0})},9451:function(t,e,r){"use strict";r("f545")},"9f3a":function(t,e,r){"use strict";var n=r("7a23");const c={class:"loader-center m-0 p-0 text-white d-flex justify-content-center align-items-center"};function s(t,e,r,s,o,i){return Object(n["v"])(),Object(n["f"])("div",c,e[0]||(e[0]=[Object(n["g"])("div",{class:"loader-ring"},null,-1),Object(n["g"])("span",null,"loading...",-1)]))}var o={},i=(r("3a38"),r("6b0d")),a=r.n(i);const u=a()(o,[["render",s],["__scopeId","data-v-1b592620"]]);e["a"]=u},ab36:function(t,e,r){"use strict";var n=r("861d"),c=r("9112");t.exports=function(t,e){n(e)&&"cause"in e&&c(t,"cause",e.cause)}},aeb0:function(t,e,r){"use strict";var n=r("9bf2").f;t.exports=function(t,e,r){r in t||n(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}},b980:function(t,e,r){"use strict";var n=r("d039"),c=r("5c6c");t.exports=!n((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",c(1,7)),7!==t.stack)}))},bd6a:function(t,e,r){},d021:function(t,e,r){"use strict";var n=r("2fa3");e["a"]={Warehousing:{create(t){return n["h"].post("/warehouse/warehousing",t)}},Shipping:{create(t){return n["h"].post("/warehouse/shipping",t)}},Outsourcinglist:{get(){return n["h"].get("/warehouse/outsourcinglist")},create(t){return n["h"].post("/warehouse/outsourcinglist/create",t)},delete(t){return n["h"].delete("/warehouse/outsourcinglist/"+t)},done(t,e){return n["h"].post(`/warehouse/outsourcinglist/${t}/done`,e)}}}},d2bb:function(t,e,r){"use strict";var n=r("7282"),c=r("861d"),s=r("1d80"),o=r("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{t=n(Object.prototype,"__proto__","set"),t(r,[]),e=r instanceof Array}catch(i){}return function(r,n){return s(r),o(n),c(r)?(e?t(r,n):r.__proto__=n,r):r}}():void 0)},d6d6:function(t,e,r){"use strict";var n=TypeError;t.exports=function(t,e){if(t<e)throw new n("Not enough arguments");return t}},d9e2:function(t,e,r){"use strict";var n=r("23e7"),c=r("cfe9"),s=r("2ba4"),o=r("e5cb"),i="WebAssembly",a=c[i],u=7!==new Error("e",{cause:7}).cause,l=function(t,e){var r={};r[t]=o(t,e,u),n({global:!0,constructor:!0,arity:1,forced:u},r)},b=function(t,e){if(a&&a[t]){var r={};r[t]=o(i+"."+t,e,u),n({target:i,stat:!0,constructor:!0,arity:1,forced:u},r)}};l("Error",(function(t){return function(e){return s(t,this,arguments)}})),l("EvalError",(function(t){return function(e){return s(t,this,arguments)}})),l("RangeError",(function(t){return function(e){return s(t,this,arguments)}})),l("ReferenceError",(function(t){return function(e){return s(t,this,arguments)}})),l("SyntaxError",(function(t){return function(e){return s(t,this,arguments)}})),l("TypeError",(function(t){return function(e){return s(t,this,arguments)}})),l("URIError",(function(t){return function(e){return s(t,this,arguments)}})),b("CompileError",(function(t){return function(e){return s(t,this,arguments)}})),b("LinkError",(function(t){return function(e){return s(t,this,arguments)}})),b("RuntimeError",(function(t){return function(e){return s(t,this,arguments)}}))},e391:function(t,e,r){"use strict";var n=r("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:n(t)}},e5cb:function(t,e,r){"use strict";var n=r("d066"),c=r("1a2d"),s=r("9112"),o=r("3a9b"),i=r("d2bb"),a=r("e893"),u=r("aeb0"),l=r("7156"),b=r("e391"),d=r("ab36"),f=r("6f19"),p=r("83ab"),g=r("c430");t.exports=function(t,e,r,h){var O="stackTraceLimit",m=h?2:1,w=t.split("."),j=w[w.length-1],v=n.apply(null,w);if(v){var y=v.prototype;if(!g&&c(y,"cause")&&delete y.cause,!r)return v;var N=n("Error"),P=e((function(t,e){var r=b(h?e:t,void 0),n=h?new v(t):new v;return void 0!==r&&s(n,"message",r),f(n,P,n.stack,2),this&&o(y,this)&&l(n,this,P),arguments.length>m&&d(n,arguments[m]),n}));if(P.prototype=y,"Error"!==j?i?i(P,N):a(P,N,{name:!0}):p&&O in v&&(u(P,v,O),u(P,v,"prepareStackTrace")),a(P,v),!g)try{y.name!==j&&s(y,"name",j),y.constructor=P}catch(I){}return P}}},edd0:function(t,e,r){"use strict";var n=r("13d2"),c=r("9bf2");t.exports=function(t,e,r){return r.get&&n(r.get,e,{getter:!0}),r.set&&n(r.set,e,{setter:!0}),c.f(t,e,r)}},f2c5:function(t,e,r){"use strict";var n=r("2fa3");e["a"]={getAll(){return n["h"].get("/production_process_items")}}},f545:function(t,e,r){},f5df:function(t,e,r){"use strict";var n=r("00ee"),c=r("1626"),s=r("c6b6"),o=r("b622"),i=o("toStringTag"),a=Object,u="Arguments"===s(function(){return arguments}()),l=function(t,e){try{return t[e]}catch(r){}};t.exports=n?s:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=l(e=a(t),i))?r:u?s(e):"Object"===(n=s(e))&&c(e.callee)?"Arguments":n}}}]);
//# sourceMappingURL=chunk-e487ee38.741d10a3.js.map