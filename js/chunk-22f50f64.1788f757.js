(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22f50f64"],{"00ee":function(t,e,r){"use strict";var n=r("b622"),s=n("toStringTag"),i={};i[s]="z",t.exports="[object z]"===String(i)},"0721":function(t,e,r){"use strict";r.r(e);var n=r("7a23");const s={class:"view bg-dark p-3"},i={class:"bg-dark mb-3 px-3"},c={class:"d-flex justify-content-between align-items-center"},a={class:"form-row"},o={class:"form-group col-md-3"},u={class:"form-group col-md-3"},b={id:"partNumbers-list"},l=["value"],h={class:"form-group col-md-3"},d={class:"form-group col-md-3"},f={class:"mt-5"},g={class:"table table-hover table-striped table-dark"},p={style:{width:"1%"}},m=["onClick"],w={style:{width:"1%"},scope:"row"},O={style:{width:"10%"}},j={style:{width:"15%"}},v={style:{width:"10%"}},y={class:"mt-5"},L={class:"table table-hover table-striped table-dark"},I={style:{width:"1%"}},S=["onClick"],N={style:{width:"1%"},scope:"row"},k={style:{width:"10%"}},x={style:{width:"15%"}},P={style:{width:"10%"}},D={key:0,class:"d-flex justify-content-end"},E=["disabled"];function T(t,e,r,T,_,U){return Object(n["L"])((Object(n["v"])(),Object(n["f"])("div",s,[Object(n["g"])("div",i,[Object(n["g"])("div",c,[e[7]||(e[7]=Object(n["g"])("h1",{class:"text-white"},"新增",-1)),Object(n["g"])("div",null,[Object(n["g"])("button",{onClick:e[0]||(e[0]=Object(n["N"])(t=>U.addNewItem("warehousing"),["stop","prevent"])),class:"btn btn-outline-warning mr-4"},"入庫"),Object(n["g"])("button",{onClick:e[1]||(e[1]=Object(n["N"])(t=>U.addNewItem("shipping"),["stop","prevent"])),class:"btn btn-outline-success mr-4"},"出庫")])]),Object(n["g"])("div",a,[Object(n["g"])("div",o,[e[8]||(e[8]=Object(n["g"])("label",{class:"add-form-label",for:"inputDate"},"日期",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>_.newItem.date=t),type:"date",class:"form-control",id:"inputDate"},null,512),[[n["H"],_.newItem.date]])]),Object(n["g"])("div",u,[e[9]||(e[9]=Object(n["g"])("label",{class:"add-form-label",for:"inputNmae"},"品番號",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>_.newItem.name=t),list:"partNumbers-list",type:"text",class:"form-control",id:"inputName"},null,512),[[n["H"],_.newItem.name]]),Object(n["g"])("datalist",b,[(Object(n["v"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(_.partNumbersList,t=>(Object(n["v"])(),Object(n["f"])("option",{key:t.id,value:t.name},null,8,l))),128))])]),Object(n["g"])("div",h,[e[10]||(e[10]=Object(n["g"])("label",{class:"add-form-label",for:"inputQuantity"},"數量",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>_.newItem.quantity=t),type:"number",class:"form-control",id:"inputQuantity"},null,512),[[n["H"],_.newItem.quantity]])]),Object(n["g"])("div",d,[e[11]||(e[11]=Object(n["g"])("label",{class:"add-form-label",for:"inputNote"},"備註",-1)),Object(n["L"])(Object(n["g"])("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>_.newItem.note=t),type:"text",class:"form-control",id:"inputNote",placeholder:"可空白..."},null,512),[[n["H"],_.newItem.note]])])])]),Object(n["g"])("div",null,[Object(n["L"])(Object(n["g"])("div",f,[e[13]||(e[13]=Object(n["g"])("h1",{class:"text-dark bg-warning m-0"},"入庫",-1)),Object(n["g"])("table",g,[e[12]||(e[12]=Object(n["g"])("thead",null,[Object(n["g"])("tr",null,[Object(n["g"])("th",{scope:"col"}),Object(n["g"])("th",{scope:"col"},"#"),Object(n["g"])("th",{scope:"col"},"日期"),Object(n["g"])("th",{scope:"col"},"品番"),Object(n["g"])("th",{scope:"col"},"數量"),Object(n["g"])("th",{scope:"col"},"備註")])],-1)),Object(n["g"])("tbody",null,[(Object(n["v"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(_.warehousingList,(t,e)=>(Object(n["v"])(),Object(n["f"])("tr",{key:e},[Object(n["g"])("td",p,[Object(n["g"])("button",{onClick:Object(n["N"])(t=>U.removeItem("warehousingList",e),["stop","prevent"]),class:"btn btn-outline-danger btn-sm rounded-circle"}," X ",8,m)]),Object(n["g"])("th",w,Object(n["D"])(e+1),1),Object(n["g"])("td",O,Object(n["D"])(t.date),1),Object(n["g"])("td",j,Object(n["D"])(t.name),1),Object(n["g"])("td",v,Object(n["D"])(t.quantity),1),Object(n["g"])("td",null,Object(n["D"])(t.note),1)]))),128))])])],512),[[n["I"],_.warehousingList.length>0]]),Object(n["L"])(Object(n["g"])("div",y,[e[15]||(e[15]=Object(n["g"])("h1",{class:"text-white bg-success m-0"},"出庫",-1)),Object(n["g"])("table",L,[e[14]||(e[14]=Object(n["g"])("thead",null,[Object(n["g"])("tr",null,[Object(n["g"])("th",{scope:"col"}),Object(n["g"])("th",{scope:"col"},"#"),Object(n["g"])("th",{scope:"col"},"日期"),Object(n["g"])("th",{scope:"col"},"品番"),Object(n["g"])("th",{scope:"col"},"數量"),Object(n["g"])("th",{scope:"col"},"備註")])],-1)),Object(n["g"])("tbody",null,[(Object(n["v"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(_.shipmentList,(t,e)=>(Object(n["v"])(),Object(n["f"])("tr",{key:e},[Object(n["g"])("td",I,[Object(n["g"])("button",{onClick:Object(n["N"])(t=>U.removeItem("shipmentList",e),["stop","prevent"]),class:"btn btn-outline-danger btn-sm rounded-circle"}," X ",8,S)]),Object(n["g"])("th",N,Object(n["D"])(e+1),1),Object(n["g"])("td",k,Object(n["D"])(t.date),1),Object(n["g"])("td",x,Object(n["D"])(t.name),1),Object(n["g"])("td",P,Object(n["D"])(t.quantity),1),Object(n["g"])("td",null,Object(n["D"])(t.note),1)]))),128))])])],512),[[n["I"],_.shipmentList.length>0]])]),_.shipmentList.length>0||_.warehousingList.length>0?(Object(n["v"])(),Object(n["f"])("div",D,[Object(n["g"])("button",{onClick:e[6]||(e[6]=Object(n["N"])((...t)=>U.handleSubmit&&U.handleSubmit(...t),["stop","prevent"])),type:"submit",class:"btn btn-primary",disabled:_.isProcessing},Object(n["D"])(_.isProcessing?"處理中...":"送出"),9,E)])):Object(n["e"])("",!0)],512)),[[n["I"],!_.isLoading]])}r("d9e2"),r("14d9");var _=r("2fa3"),U=r("575a"),R=r("d021"),C={name:"ShippingWarehousing",created(){this.fetchTodaysDate(),this.fetchPartNumbers(),this.fetchSubPartNumbers(),this.isLoading=!this.isLoading},data(){return{partNumbersList:[],subPartNumbersList:[],newItem:{productId:"",date:"",name:"",quantity:"",note:"",isSubPart:!1},shipmentList:[],warehousingList:[],isProcessing:!1,isLoading:!0}},methods:{async fetchPartNumbers(){try{const{data:t,status:e,statusText:r}=await U["a"].getPartNumbers();if("OK"!==r&&200!==e)throw new Error;const{partNumbers:n}=t;this.partNumbersList=n}catch(t){_["c"].fire({icon:"error",title:"載入資料錯誤，請稍後在試。"})}},async fetchSubPartNumbers(){try{const{data:t,status:e,statusText:r}=await U["a"].getSubPartNumbers();if("OK"!==r&&200!==e)throw new Error;const{subPartNumbers:n}=t;this.subPartNumbersList=n}catch(t){_["c"].fire({icon:"error",title:"載入資料錯誤，請稍後在試。"})}},fetchTodaysDate(){let t=(new Date).getFullYear().toString(),e="",r="";e=(new Date).getMonth()<9?"0"+((new Date).getMonth()+1).toString():((new Date).getMonth()+1).toString(),r=(new Date).getDate()<10?"0"+(new Date).getDate().toString():(new Date).getDate().toString();const n=`${t}-${e}-${r}`;this.newItem.date=n},async addNewItem(t){try{const{date:e,name:r,quantity:n}=this.newItem;if(!e||!r||!n)return void _["b"].fire({icon:"warning",title:"日、品番號、數量不可空白"});let s=!1;if(this.partNumbersList.map(t=>{if(t.name===this.newItem.name){this.newItem.productId=t.id;const{subPartNumbers:e}=t;if(e.length)for(const r of e)if(!r.usagePerUnit>0)throw new Error(`${t.name} 其子部品 ${r.name} 尚未設定每單位使用量`);s=!0}}),this.subPartNumbersList.map(t=>{t.name===this.newItem.name&&(this.newItem.productId=t.id,this.newItem.isSubPart=!0,s=!0)}),!s)throw new Error("此品番不存在");if("warehousing"===t)return this.warehousingList.push({...this.newItem}),this.newItem.productId="",this.newItem.name="",this.newItem.quantity="",this.newItem.note="",void(this.newItem.isSubPart=!1);if("shipping"===t)return this.shipmentList.push({...this.newItem}),this.newItem.productId="",this.newItem.name="",this.newItem.quantity="",this.newItem.note="",void(this.newItem.isSubPart=!1)}catch(e){_["b"].fire({icon:"error",title:e||"發生不明錯誤!"})}},async removeItem(t,e){try{if("warehousingList"===t)return void this.warehousingList.splice(e,1);if("shipmentList"===t)return void this.shipmentList.splice(e,1)}catch(r){_["c"].fire({icon:"error",title:"錯誤，再試一次。"})}},async handleSubmit(){try{if(this.isProcessing=!0,this.warehousingList.length){const t=new FormData;t.append("warehousingList",JSON.stringify(this.warehousingList));const{data:e,statusText:r}=await R["a"].Warehousing.create(t),n=e.status,s=e.message;if(console.log(n),"success"!==n&&"OK"!==r)throw new Error(s||"入庫時發生錯誤，請稍後在試。");this.warehousingList=[]}if(this.shipmentList.length){const t=new FormData;t.append("shipmentList",JSON.stringify(this.shipmentList));const{data:e,statusText:r}=await R["a"].Shipping.create(t),n=e.status,s=e.message;if("success"!==n&&"OK"!==r)throw new Error(s||"出貨時發生錯誤，請稍後在試。");this.shipmentList=[]}_["g"].fire({title:"成功",text:"資料登載成功"}),this.isProcessing=!1}catch(t){_["f"].fire({title:"Oops...",text:t.message}),this.isProcessing=!1}}}},q=(r("c3a1"),r("6b0d")),z=r.n(q);const $=z()(C,[["render",T],["__scopeId","data-v-d9195d4e"]]);e["default"]=$},"0d26":function(t,e,r){"use strict";var n=r("e330"),s=Error,i=n("".replace),c=function(t){return String(new s(t).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,o=a.test(c);t.exports=function(t,e){if(o&&"string"==typeof t&&!s.prepareStackTrace)while(e--)t=i(t,a,"");return t}},1787:function(t,e,r){"use strict";var n=r("861d");t.exports=function(t){return n(t)||null===t}},"271a":function(t,e,r){"use strict";var n=r("cb2d"),s=r("e330"),i=r("577e"),c=r("d6d6"),a=URLSearchParams,o=a.prototype,u=s(o.getAll),b=s(o.has),l=new a("a=1");!l.has("a",2)&&l.has("a",void 0)||n(o,"has",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return b(this,t);var n=u(this,t);c(e,1);var s=i(r),a=0;while(a<n.length)if(n[a++]===s)return!0;return!1}),{enumerable:!0,unsafe:!0})},"2ba4":function(t,e,r){"use strict";var n=r("40d5"),s=Function.prototype,i=s.apply,c=s.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?c.bind(i):function(){return c.apply(i,arguments)})},"3bbe":function(t,e,r){"use strict";var n=r("1787"),s=String,i=TypeError;t.exports=function(t){if(n(t))return t;throw new i("Can't set "+s(t)+" as a prototype")}},5494:function(t,e,r){"use strict";var n=r("83ab"),s=r("e330"),i=r("edd0"),c=URLSearchParams.prototype,a=s(c.forEach);n&&!("size"in c)&&i(c,"size",{get:function(){var t=0;return a(this,(function(){t++})),t},configurable:!0,enumerable:!0})},"575a":function(t,e,r){"use strict";r("88a7"),r("271a"),r("5494");var n=r("2fa3");e["a"]={getPartNumbers(t){const e=new URLSearchParams(t);return n["h"].get("/warehouse/partnumbers?"+e.toString())},getSubPartNumbers(){return n["h"].get("/warehouse/subpartnumbers")},getSearchPartNumbers(t){const e=new URLSearchParams(t);return n["h"].get("/warehouse/partnumbers/search?"+e.toString())}}},"577e":function(t,e,r){"use strict";var n=r("f5df"),s=String;t.exports=function(t){if("Symbol"===n(t))throw new TypeError("Cannot convert a Symbol value to a string");return s(t)}},"6f19":function(t,e,r){"use strict";var n=r("9112"),s=r("0d26"),i=r("b980"),c=Error.captureStackTrace;t.exports=function(t,e,r,a){i&&(c?c(t,e):n(t,"stack",s(r,a)))}},7156:function(t,e,r){"use strict";var n=r("1626"),s=r("861d"),i=r("d2bb");t.exports=function(t,e,r){var c,a;return i&&n(c=e.constructor)&&c!==r&&s(a=c.prototype)&&a!==r.prototype&&i(t,a),t}},7282:function(t,e,r){"use strict";var n=r("e330"),s=r("59ed");t.exports=function(t,e,r){try{return n(s(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(i){}}},"88a7":function(t,e,r){"use strict";var n=r("cb2d"),s=r("e330"),i=r("577e"),c=r("d6d6"),a=URLSearchParams,o=a.prototype,u=s(o.append),b=s(o["delete"]),l=s(o.forEach),h=s([].push),d=new a("a=1&a=2&b=3");d["delete"]("a",1),d["delete"]("b",void 0),d+""!=="a=2"&&n(o,"delete",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return b(this,t);var n=[];l(this,(function(t,e){h(n,{key:e,value:t})})),c(e,1);var s,a=i(t),o=i(r),d=0,f=0,g=!1,p=n.length;while(d<p)s=n[d++],g||s.key===a?(g=!0,b(this,s.key)):f++;while(f<p)s=n[f++],s.key===a&&s.value===o||u(this,s.key,s.value)}),{enumerable:!0,unsafe:!0})},ab36:function(t,e,r){"use strict";var n=r("861d"),s=r("9112");t.exports=function(t,e){n(e)&&"cause"in e&&s(t,"cause",e.cause)}},aeb0:function(t,e,r){"use strict";var n=r("9bf2").f;t.exports=function(t,e,r){r in t||n(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}},b980:function(t,e,r){"use strict";var n=r("d039"),s=r("5c6c");t.exports=!n((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",s(1,7)),7!==t.stack)}))},c3a1:function(t,e,r){"use strict";r("e637")},d021:function(t,e,r){"use strict";var n=r("2fa3");e["a"]={Warehousing:{create(t){return n["h"].post("/warehouse/warehousing",t)}},Shipping:{create(t){return n["h"].post("/warehouse/shipping",t)}},Outsourcinglist:{get(){return n["h"].get("/warehouse/outsourcinglist")},create(t){return n["h"].post("/warehouse/outsourcinglist/create",t)},delete(t){return n["h"].delete("/warehouse/outsourcinglist/"+t)},done(t,e){return n["h"].post(`/warehouse/outsourcinglist/${t}/done`,e)}}}},d2bb:function(t,e,r){"use strict";var n=r("7282"),s=r("861d"),i=r("1d80"),c=r("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{t=n(Object.prototype,"__proto__","set"),t(r,[]),e=r instanceof Array}catch(a){}return function(r,n){return i(r),c(n),s(r)?(e?t(r,n):r.__proto__=n,r):r}}():void 0)},d6d6:function(t,e,r){"use strict";var n=TypeError;t.exports=function(t,e){if(t<e)throw new n("Not enough arguments");return t}},d9e2:function(t,e,r){"use strict";var n=r("23e7"),s=r("cfe9"),i=r("2ba4"),c=r("e5cb"),a="WebAssembly",o=s[a],u=7!==new Error("e",{cause:7}).cause,b=function(t,e){var r={};r[t]=c(t,e,u),n({global:!0,constructor:!0,arity:1,forced:u},r)},l=function(t,e){if(o&&o[t]){var r={};r[t]=c(a+"."+t,e,u),n({target:a,stat:!0,constructor:!0,arity:1,forced:u},r)}};b("Error",(function(t){return function(e){return i(t,this,arguments)}})),b("EvalError",(function(t){return function(e){return i(t,this,arguments)}})),b("RangeError",(function(t){return function(e){return i(t,this,arguments)}})),b("ReferenceError",(function(t){return function(e){return i(t,this,arguments)}})),b("SyntaxError",(function(t){return function(e){return i(t,this,arguments)}})),b("TypeError",(function(t){return function(e){return i(t,this,arguments)}})),b("URIError",(function(t){return function(e){return i(t,this,arguments)}})),l("CompileError",(function(t){return function(e){return i(t,this,arguments)}})),l("LinkError",(function(t){return function(e){return i(t,this,arguments)}})),l("RuntimeError",(function(t){return function(e){return i(t,this,arguments)}}))},e391:function(t,e,r){"use strict";var n=r("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:n(t)}},e5cb:function(t,e,r){"use strict";var n=r("d066"),s=r("1a2d"),i=r("9112"),c=r("3a9b"),a=r("d2bb"),o=r("e893"),u=r("aeb0"),b=r("7156"),l=r("e391"),h=r("ab36"),d=r("6f19"),f=r("83ab"),g=r("c430");t.exports=function(t,e,r,p){var m="stackTraceLimit",w=p?2:1,O=t.split("."),j=O[O.length-1],v=n.apply(null,O);if(v){var y=v.prototype;if(!g&&s(y,"cause")&&delete y.cause,!r)return v;var L=n("Error"),I=e((function(t,e){var r=l(p?e:t,void 0),n=p?new v(t):new v;return void 0!==r&&i(n,"message",r),d(n,I,n.stack,2),this&&c(y,this)&&b(n,this,I),arguments.length>w&&h(n,arguments[w]),n}));if(I.prototype=y,"Error"!==j?a?a(I,L):o(I,L,{name:!0}):f&&m in v&&(u(I,v,m),u(I,v,"prepareStackTrace")),o(I,v),!g)try{y.name!==j&&i(y,"name",j),y.constructor=I}catch(S){}return I}}},e637:function(t,e,r){},edd0:function(t,e,r){"use strict";var n=r("13d2"),s=r("9bf2");t.exports=function(t,e,r){return r.get&&n(r.get,e,{getter:!0}),r.set&&n(r.set,e,{setter:!0}),s.f(t,e,r)}},f5df:function(t,e,r){"use strict";var n=r("00ee"),s=r("1626"),i=r("c6b6"),c=r("b622"),a=c("toStringTag"),o=Object,u="Arguments"===i(function(){return arguments}()),b=function(t,e){try{return t[e]}catch(r){}};t.exports=n?i:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=b(e=o(t),a))?r:u?i(e):"Object"===(n=i(e))&&s(e.callee)?"Arguments":n}}}]);
//# sourceMappingURL=chunk-22f50f64.1788f757.js.map