import{m as u}from"./managers-D29on_NM.js";import{P as w}from"./PageLoader-CRhFpXTD.js";import{_ as v,z as b,T as m,s as C,c as i,g as _,f,b as t,h as y,F as x,r as L,j as g,o as l,i as k,t as a}from"./index-DBV31kNq.js";const B={name:"ManagerCustomers",components:{PageLoader:w},computed:{...b(["currentUser"])},created(){this.fetchCustomers()},data(){return{users:[],isLoading:!0}},methods:{async fetchCustomers(){try{this.isLoading=!0;const{data:o,status:e,statusText:n}=await u.users.get();if(n!=="OK"&&e!==200)throw new Error;const{users:d}=o;this.users=d,this.isLoading=!1}catch{m.fire({icon:"error",title:"載入錯誤，請稍後再試。"}),this.isLoading=!1}},async deleteUser(o,e){try{if(this.currentUser.name===e)throw new Error("不可刪除自己!!");if(e==="root")throw new Error("此為root，不可刪除!!");if((await C.fire({showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",icon:"warning",title:"確定刪除?",text:`確定後，你將刪除此使用者'${e}'。`,confirmButtonText:"確定"})).value){const{data:d,status:r,statusText:c}=await u.users.delete(o);if(c!=="OK"&&r!==200)throw new Error;this.users=this.users.filter(h=>h.id!==o),m.fire({icon:"success",title:d.message})}}catch(n){m.fire({icon:"error",title:n||"錯誤!!請稍後在試!!"})}}}},T={class:"m-5"},A={key:0},V={key:1},z={class:"d-flex justify-content-end mr-3"},E={class:"table table-hover table-striped table-dark"},P={class:"align-middle",scope:"row"},U={class:"align-middle"},H={class:"align-middle"},M={class:"align-middle"},j={class:"align-middle"},F={class:"align-middle"},K={class:"py-1 align-middle"},N=["onClick"];function O(o,e,n,d,r,c){const h=g("PageLoader"),p=g("router-link");return l(),i("div",T,[r.isLoading?(l(),i("div",A,[_(h)])):f("",!0),r.isLoading?f("",!0):(l(),i("div",V,[t("div",z,[_(p,{to:{name:"manager-users-new"},class:"btn btn-primary btn-lg my-3"},{default:y(()=>e[0]||(e[0]=[k("+使用者")])),_:1})]),t("table",E,[e[2]||(e[2]=t("thead",null,[t("tr",null,[t("th",{scope:"col"},[t("h3",null,"#")]),t("th",{scope:"col"},[t("h3",null,"名稱")]),t("th",{scope:"col"},[t("h3",null,"isAdmin")]),t("th",{scope:"col"},[t("h3",null,"權限等級")]),t("th",{scope:"col"},[t("h3",null,"更新日期")]),t("th",{scope:"col"},[t("h3",null,"新增日期")]),t("th",{scope:"col"},[t("h3",null,"操作")])])],-1)),t("tbody",null,[(l(!0),i(x,null,L(r.users,s=>(l(),i("tr",{key:s.id},[t("td",P,[t("h4",null,a(s.id),1)]),t("td",U,[t("h4",null,a(s.name),1)]),t("td",H,[t("h4",null,a(s.isAdmin),1)]),t("td",M,[t("h4",null,a(s.permissionLevel),1)]),t("td",j,[t("h4",null,a(s.updatedAt),1)]),t("td",F,[t("h4",null,a(s.createdAt),1)]),t("td",K,[t("button",{onClick:S=>c.deleteUser(s.id,s.name),class:"btn btn-outline-danger btn-lg"},e[1]||(e[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash-fill",viewBox:"0 0 16 16"},[t("path",{d:"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"})],-1)]),8,N)])]))),128))])])]))])}const G=v(B,[["render",O]]);export{G as default};
