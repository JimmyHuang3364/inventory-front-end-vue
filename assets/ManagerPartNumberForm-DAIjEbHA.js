import{_ as h,T as p,m as c,w as i,e as w,o as n,c as u,b as e,t as b,i as d,F as P,r as N,l as y,x as D,v as m,f as k,d as v}from"./index-BMeqUuqK.js";import{m as g}from"./managers-CGvdj1Ci.js";const C={name:"ManagerPartNumberForm",props:{initialPartNumber:{type:Object,default:()=>({affiliatedPartNumber:"",name:"",usagePerUnit:1,unitPrice:0,quantity:0,safetyStockQuantity:0,commonName:""})},isProcessing:{type:Boolean,default:!1}},created(){this.fetchPartNumbers(),this.fetchCustomers(),this.isLoading=!1},data(){return{belongsToCutomerId:"",customers:[],newPartNumberData:{affiliatedPartNumber:"",name:"",usagePerUnit:1,unitPrice:0,quantity:0,safetyStockQuantity:0,commonName:""},partNumbers:[],partNumbersList:[],subPartNumberCheck:!1,isLoading:!0}},methods:{async fetchPartNumbers(){try{const{data:a,status:t,statusText:o}=await g.partNumbers.get();if(o!=="OK"&&t!==200)throw new Error;const{partNumbers:l}=a;this.partNumbers=l,this.partNumbersList={...l}}catch{p.fire({icon:"error",title:"載入錯誤，請稍後在試!!"})}},async fetchCustomers(){try{const{data:a,status:t,statusText:o}=await g.customers.get();if(o!=="OK"&&t!==200)throw new Error;const{customers:l}=a;this.customers=l}catch{p.fire({icon:"error",title:"載入錯誤，請稍後在試!!"})}},filterPartNumbersDataList(a){this.partNumbersList=this.partNumbers.filter(t=>t.CustomerId===a),this.partNumbersList=this.partNumbersList.filter(t=>t.name!==this.newPartNumberData.name)},handleSubmit(a){if(!this.belongsToCutomerId||!this.newPartNumberData.name){c.fire({icon:"warning",title:"必填項目請填寫完整"});return}if(this.subPartNumberCheck&&!this.newPartNumberData.affiliatedPartNumber||this.subPartNumberCheck&&!this.newPartNumberData.usagePerUnit){c.fire({icon:"warning",title:"必填項目請填寫完整"});return}const t=a.target,o=new FormData(t);this.$emit("after-submit",o)}},watch:{belongsToCutomerId(a){this.filterPartNumbersDataList(a)},subPartNumberCheck(){this.filterPartNumbersDataList(this.belongsToCutomerId)},initialPartNumber(a){this.belongsToCutomerId=a.customerId,this.newPartNumberData.name=a.name,this.newPartNumberData.affiliatedPartNumber=a.PartNumberId,this.newPartNumberData.usagePerUnit=a.usagePerUnit,this.newPartNumberData.unitPrice=a.unitPrice,this.newPartNumberData.quantity=a.quantity,this.newPartNumberData.safetyStockQuantity=a.safetyStockQuantity,this.newPartNumberData.commonName=a.commonName,this.subPartNumberCheck=a.isSubPartNumber}}},x={class:"m-3 pb-3"},U={class:"text-white"},S={class:"form-group"},L=["value"],T={class:"form-group"},I={for:"name"},_={key:0,class:"form-group border border-warning rounded p-2",style:{"background-color":"midnightblue"}},q={class:"row"},Q={class:"col"},M={class:"input-group input-group-sm p-0"},B=["value"],F={class:"col"},z={class:"input-group input-group-sm p-0"},V={class:"form-group"},E={class:"form-group"},O={class:"form-group"},j={class:"form-group"},K={class:"d-flex justify-content-end"},A=["disabled"];function G(a,t,o,l,s,f){return i((n(),u("div",x,[e("h1",U,b(o.initialPartNumber.name?"修改部品":"新增部品"),1),e("form",{onSubmit:t[9]||(t[9]=v((...r)=>f.handleSubmit&&f.handleSubmit(...r),["stop","prevent"]))},[e("div",S,[t[10]||(t[10]=e("label",{for:"exampleFormControlSelect1"},[d("発注人"),e("span",{class:"text-danger ml-1",style:{"font-size":"10px"}},"(必填)")],-1)),i(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.belongsToCutomerId=r),class:"form-control",name:"customer",id:"customer"},[(n(!0),u(P,null,N(s.customers,r=>(n(),u("option",{key:r.id,value:r.id},b(r.name),9,L))),128))],512),[[y,s.belongsToCutomerId]])]),e("div",T,[e("label",I,[d(b(s.subPartNumberCheck?"子部品番號":"部品番號"),1),t[11]||(t[11]=e("span",{class:"text-danger ml-1",style:{"font-size":"10px"}},"(必填)",-1)),i(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>s.subPartNumberCheck=r),class:"ml-5 sub-part-check-box",type:"checkbox",name:"",id:"subPartNumberCheck"},null,512),[[D,s.subPartNumberCheck]]),t[12]||(t[12]=d()),t[13]||(t[13]=e("label",{for:"subPartNumberCheck",class:"sub-part-check-box-label"},"子部品",-1))]),i(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>s.newPartNumberData.name=r),type:"text",class:"form-control",name:"name",id:"name",placeholder:""},null,512),[[m,s.newPartNumberData.name]])]),s.subPartNumberCheck?(n(),u("div",_,[e("div",q,[e("div",Q,[t[14]||(t[14]=e("label",{for:""},[d("母部品"),e("span",{class:"text-danger ml-1",style:{"font-size":"10px"}},"(必填)")],-1)),e("div",M,[i(e("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>s.newPartNumberData.affiliatedPartNumber=r),list:"partnumberList",type:"text",class:"custom-select",name:"affiliatedPartNumber",id:"affiliatedPartNumber",placeholder:"番號",value:""},[(n(!0),u(P,null,N(s.partNumbersList,r=>(n(),u("option",{key:r.id,value:r.id},b(r.name),9,B))),128))],512),[[y,s.newPartNumberData.affiliatedPartNumber]])])]),e("div",F,[t[15]||(t[15]=e("label",{for:""},[d("每單位使用量"),e("span",{class:"text-danger ml-1",style:{"font-size":"10px"}},"(必填)")],-1)),e("div",z,[i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>s.newPartNumberData.usagePerUnit=r),type:"number",class:"form-control",name:"usagePerUnit",id:"usagePerUnit",value:"1",min:"1"},null,512),[[m,s.newPartNumberData.usagePerUnit]])])])])])):k("",!0),e("div",V,[t[16]||(t[16]=e("label",{for:"unitPrice"},"單價",-1)),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>s.newPartNumberData.unitPrice=r),type:"number",class:"form-control",name:"unitPrice",id:"unitPrice",min:"0",step:"0.01"},null,512),[[m,s.newPartNumberData.unitPrice]])]),e("div",E,[t[17]||(t[17]=e("label",{for:"inputCity"},"初設數量",-1)),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>s.newPartNumberData.quantity=r),type:"number",class:"form-control",name:"quantity",id:"quantity",min:"0"},null,512),[[m,s.newPartNumberData.quantity]])]),e("div",O,[t[18]||(t[18]=e("label",{for:"inputCity"},"安全數量設定",-1)),i(e("input",{"onUpdate:modelValue":t[7]||(t[7]=r=>s.newPartNumberData.safetyStockQuantity=r),type:"number",class:"form-control",name:"safetyStockQuantity",id:"safetyStockQuantity",min:"0"},null,512),[[m,s.newPartNumberData.safetyStockQuantity]])]),e("div",j,[t[19]||(t[19]=e("label",{for:"inputCity"},"備註",-1)),i(e("input",{"onUpdate:modelValue":t[8]||(t[8]=r=>s.newPartNumberData.commonName=r),type:"text",class:"form-control",name:"commonName",id:"commonName"},null,512),[[m,s.newPartNumberData.commonName]])]),e("div",K,[e("button",{type:"submit",class:"btn btn-primary mt-3",disabled:o.isProcessing},b(o.isProcessing?"處理中...":"送出"),9,A)])],32)],512)),[[w,!s.isLoading]])}const R=h(C,[["render",G],["__scopeId","data-v-9b4dbe54"]]);export{R as M};
