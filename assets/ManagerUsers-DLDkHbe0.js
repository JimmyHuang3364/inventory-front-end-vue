import{d as y,u as k,G as x,r as h,j as B,o as r,c as i,k as m,i as f,b as t,l as T,p as A,F as V,h as E,t as n,T as d,B as z,q as H}from"./index-DT4Oj6RD.js";import{m as v}from"./managers-DSWYMohW.js";import{P as L}from"./PageLoader-Dis3K9TT.js";const M={class:"m-5"},U={key:0},P={key:1},S={class:"d-flex justify-content-end mr-3"},j={class:"table table-hover table-striped table-dark"},F={class:"align-middle",scope:"row"},K={class:"align-middle"},N={class:"align-middle"},O={class:"align-middle"},$={class:"align-middle"},q={class:"align-middle"},D={class:"py-1 align-middle"},G=["onClick"],W=y({__name:"ManagerUsers",setup(R){const _=k(),{currentUser:p}=x(_),c=h([]),l=h(!0),g=async()=>{try{l.value=!0;const{data:a,status:s,statusText:o}=await v.users.get();if(o!=="OK"&&s!==200)throw new Error;const e=a.users;c.value=e,l.value=!1}catch{d.fire({icon:"error",title:"載入錯誤，請稍後再試。"}),l.value=!1}},w=async(a,s)=>{try{if(p.value.name===s)throw new Error("不可刪除自己!!");if(s==="root")throw new Error("此為root，不可刪除!!");if((await z.fire({showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",icon:"warning",title:"確定刪除?",text:`確定後，你將刪除此使用者'${s}'。`,confirmButtonText:"確定"})).value){const{data:e,status:u,statusText:b}=await v.users.delete(a);if(b!=="OK"&&u!==200)throw new Error;c.value=c.value.filter(C=>C.id!==a),d.fire({icon:"success",title:e.message})}}catch(o){d.fire({icon:"error",title:o||"錯誤!!請稍後在試!!"})}};return B(()=>{g()}),(a,s)=>{const o=H("router-link");return r(),i("div",M,[l.value?(r(),i("div",U,[m(L)])):f("",!0),l.value?f("",!0):(r(),i("div",P,[t("div",S,[m(o,{to:{name:"manager-users-new"},class:"btn btn-primary btn-lg my-3"},{default:T(()=>s[0]||(s[0]=[A("+使用者")])),_:1})]),t("table",j,[s[2]||(s[2]=t("thead",null,[t("tr",null,[t("th",{scope:"col"},[t("h3",null,"#")]),t("th",{scope:"col"},[t("h3",null,"名稱")]),t("th",{scope:"col"},[t("h3",null,"isAdmin")]),t("th",{scope:"col"},[t("h3",null,"權限等級")]),t("th",{scope:"col"},[t("h3",null,"更新日期")]),t("th",{scope:"col"},[t("h3",null,"新增日期")]),t("th",{scope:"col"},[t("h3",null,"操作")])])],-1)),t("tbody",null,[(r(!0),i(V,null,E(c.value,e=>(r(),i("tr",{key:e.id},[t("td",F,[t("h4",null,n(e.id),1)]),t("td",K,[t("h4",null,n(e.name),1)]),t("td",N,[t("h4",null,n(e.isAdmin),1)]),t("td",O,[t("h4",null,n(e.permissionLevel),1)]),t("td",$,[t("h4",null,n(e.updatedAt),1)]),t("td",q,[t("h4",null,n(e.createdAt),1)]),t("td",D,[t("button",{onClick:u=>w(e.id,e.name),class:"btn btn-outline-danger btn-lg"},s[1]||(s[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash-fill",viewBox:"0 0 16 16"},[t("path",{d:"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"})],-1)]),8,G)])]))),128))])])]))])}}});export{W as default};
